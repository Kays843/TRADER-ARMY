<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Trade Army | Pro Terminal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* SERT BASMA SORUNU ÇÖZÜMÜ: TOUCH-ACTION AYARI */
        html, body { 
            background-color: #0c0d10; 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            overflow: hidden; 
            -webkit-user-select: none; 
            touch-action: none; /* Sayfanın kendi kaymasını iptal et */
        }
        
        #chart-grid { display: grid; height: 100%; width: 100%; gap: 1px; background-color: #1e222d; }
        .grid-1 { grid-template-columns: 1fr; }
        .grid-2 { grid-template-columns: 1fr 1fr; }
        .grid-3 { grid-template-columns: 1fr 1fr 1fr; }
        .grid-4 { grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr; }

        /* Tıklama hızını artıran kritik CSS */
        iframe { 
            pointer-events: auto !important; 
            touch-action: auto !important;
            -webkit-tap-highlight-color: transparent;
        }

        .btn-active { background: #2962ff !important; color: white !important; }
        .layout-btn { background: #131722; color: #81858e; border: 1px solid #1e222d; padding: 4px 12px; border-radius: 4px; font-size: 12px; }
        .nav-btn { flex: 1; background: #131722; color: #d1d4dc; font-size: 11px; font-weight: bold; border: none; outline: none; }
        .nav-btn:active { background: #1e222d; }
    </style>
</head>
<body class="flex flex-col">

    <header class="h-14 border-b border-[#1e222d] bg-[#131722] flex items-center justify-between px-4 shrink-0">
        <div class="flex items-center space-x-2">
            <span class="text-blue-500 font-black italic text-xl">TRADE <span class="text-white">ARMY</span></span>
        </div>
        
        <div class="flex items-center space-x-1">
            <button onclick="changeLayout(1, this)" class="layout-btn btn-active">1</button>
            <button onclick="changeLayout(2, this)" class="layout-btn">2</button>
            <button onclick="changeLayout(4, this)" class="layout-btn">4</button>
        </div>
    </header>

    <main class="flex-1 overflow-hidden relative">
        <div id="chart-grid" class="grid-1">
            <div id="tv_chart_1" class="w-full h-full"></div>
            <div id="tv_chart_2" class="w-full h-full hidden"></div>
            <div id="tv_chart_3" class="w-full h-full hidden"></div>
            <div id="tv_chart_4" class="w-full h-full hidden"></div>
        </div>
    </main>

    <nav class="h-14 border-t border-[#1e222d] flex shrink-0">
        <button onclick="updateSymbol('BINANCE:BTCUSDT')" class="nav-btn border-r border-gray-800">BTC</button>
        <button onclick="updateSymbol('BINANCE:ETHUSDT')" class="nav-btn border-r border-gray-800">ETH</button>
        <button onclick="updateSymbol('TVC:GOLD')" class="nav-btn border-r border-gray-800">ALTIN</button>
        <button onclick="updateSymbol('FX:USDTRY')" class="nav-btn">USD/TRY</button>
    </nav>

    <footer class="h-6 bg-black flex items-center justify-between px-4 text-[9px] text-gray-600 shrink-0">
        <div>© 2026 TRADE ARMY</div>
        <div>Yatırım tavsiyesi değildir.</div>
    </footer>

    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    <script>
        let currentSymbol = 'BINANCE:BTCUSDT';
        let currentCount = 1;

        function initChart(id, symbol) {
            new TradingView.widget({
                "autosize": true,
                "symbol": symbol,
                "interval": "240",
                "timezone": "Etc/UTC",
                "theme": "dark",
                "style": "1",
                "locale": "tr",
                "toolbar_bg": "#131722",
                "enable_publishing": false,
                "hide_side_toolbar": false, // Çizim araçları
                "allow_symbol_change": true,
                "container_id": id,
                "library_path": "https://s3.tradingview.com/tv.js", // Kütüphaneyi zorla doğrular
                "withdateranges": true,
                // DOKUNMATİK HASSASİYETİ İÇİN AKTİF EDİLEN ÖZELLİKLER
                "enabled_features": [
                    "header_resolutions", 
                    "header_indicators", 
                    "header_settings", 
                    "header_chart_type",
                    "side_toolbar_in_fullscreen_mode",
                    "header_symbol_search",
                    "dont_show_boolean_column_and_unfilled_cells" // Hafifletme
                ],
                "overrides": {
                    "paneProperties.background": "#131722",
                    "mainSeriesProperties.style": 1
                }
            });
        }

        function changeLayout(count, btn) {
            currentCount = count;
            document.getElementById('chart-grid').className = `grid-${count}`;
            
            // Buton Tasarımı
            document.querySelectorAll('.layout-btn').forEach(b => b.classList.remove('btn-active'));
            if(btn) btn.classList.add('btn-active');

            for (let i = 1; i <= 4; i++) {
                const container = document.getElementById(`tv_chart_${i}`);
                if (i <= count) {
                    container.classList.remove('hidden');
                    initChart(`tv_chart_${i}`, currentSymbol);
                } else {
                    if (container) {
                        container.classList.add('hidden');
                        container.innerHTML = "";
                    }
                }
            }
        }

        function updateSymbol(s) {
            currentSymbol = s;
            for (let i = 1; i <= currentCount; i++) {
                initChart(`tv_chart_${i}`, s);
            }
        }

        // Başlat
        window.onload = () => initChart('tv_chart_1', currentSymbol);
    </script>
</body>
</html>
