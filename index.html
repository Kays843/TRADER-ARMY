<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>TraderArmy Chart</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: #0e0e0e;
      color: #fff;
      font-family: Arial, sans-serif;
      height: 100%;
    }

    header {
      background: #111;
      padding: 10px 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #222;
    }

    select {
      background: #1c1c1c;
      color: #fff;
      border: 1px solid #333;
      padding: 6px;
      border-radius: 4px;
    }

    #chart {
      height: calc(100vh - 120px);
    }

    footer {
      background: #111;
      color: #aaa;
      font-size: 12px;
      padding: 10px;
      text-align: center;
      border-top: 1px solid #222;
    }
  </style>
</head>

<body>

<header>
  <strong>TraderArmy</strong>

  <!-- PARİTE SEÇİMİ -->
  <select id="symbolSelect">
    <option value="NASDAQ:US100">US100 (Nasdaq)</option>
    <option value="OANDA:EURUSD">EURUSD</option>
    <option value="BINANCE:BTCUSDT">BTCUSDT</option>
    <option value="BINANCE:ETHUSDT">ETHUSDT</option>
  </select>
</header>

<div id="chart"></div>

<footer>
  ⚠️ Yasal Uyarı: Bu sitede yer alan bilgiler yatırım tavsiyesi değildir.
  Finansal işlemler risk içerir, tüm sorumluluk kullanıcıya aittir.
</footer>

<!-- 1️⃣ ÖNCE TradingView KÜTÜPHANESİ -->
<script src="https://s3.tradingview.com/tv.js"></script>

<!-- 2️⃣ SONRA BİZİM KOD -->
<script>
  let widget;

  const select = document.getElementById("symbolSelect");
  const savedSymbol = localStorage.getItem("symbol") || "NASDAQ:US100";
  select.value = savedSymbol;

  function loadChart(symbol) {
    if (widget) {
      widget.remove();
    }

    widget = new TradingView.widget({
      container_id: "chart",
      autosize: true,
      symbol: symbol,
      interval: "5",
      timezone: "Europe/Istanbul",
      theme: "dark",
      style: "1",
      locale: "tr",
      hide_side_toolbar: false,
      allow_symbol_change: true,
      withdateranges: true,
      save_image: true
    });
  }

  // ilk açılış
  loadChart(savedSymbol);

  // parite değişince
  select.addEventListener("change", function () {
    localStorage.setItem("symbol", this.value);
    loadChart(this.value);
  });
</script>

</body>
</html>
