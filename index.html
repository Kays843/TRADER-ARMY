<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRADE ARMY V1 | SELECTABLE GRID</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #000; color: #d1d4dc; font-family: sans-serif; overflow: hidden; height: 100vh; margin: 0; display: flex; flex-direction: column; }
        .header { height: 50px; background: #131722; border-bottom: 1px solid #2a2e39; display: flex; align-items: center; justify-content: space-between; padding: 0 15px; shrink-0; }
        .main-content { flex: 1; position: relative; background: #1e222d; overflow: hidden; }
        
        /* DİNAMİK GRID YAPISI */
        #chart-grid { display: grid; height: 100%; width: 100%; gap: 1px; }
        .grid-1 { grid-template-columns: 1fr; }
        .grid-2 { grid-template-columns: 1fr 1fr; }
        .grid-3 { grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr; } /* 3'lüde 4. slot boş kalır veya 1 büyük 2 küçük yapılır */
        .grid-4 { grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr; }

        .chart-box { background: #000; width: 100%; height: 100%; }
        .btn-layout { background: #1e222d; color: #5d606b; padding: 4px 10px; border-radius: 4px; font-weight: bold; font-size: 12px; transition: 0.2s; border: 1px solid #2a2e39; }
        .btn-layout:hover, .active-layout { background: #2962ff; color: white; border-color: #2962ff; }
        
        .footer-fixed { height: 30px; background: #0c0d10; border-top: 1px solid #2a2e39; display: flex; align-items: center; justify-content: center; font-size: 10px; color: #5d606b; shrink-0; }
    </style>
</head>
<body>

    <header class="header">
        <div class="flex items-center space-x-3">
            <h1 class="text-white font-black italic tracking-tighter text-lg uppercase">Trade Army <span class="text-blue-500">V1</span></h1>
            <button onclick="window.open('https://www.tradingview.com/accounts/signin/', '_blank')" class="bg-blue-600 text-white text-[10px] px-3 py-1.5 rounded font-bold uppercase">1. HESABA GİRİŞ YAP</button>
            <button onclick="location.reload()" class="bg-gray-800 text-gray-300 text-[10px] px-3 py-1.5 rounded font-bold border border-white/10">2. YENİLE</button>
        </div>

        <div class="flex items-center space-x-2 bg-black/40 p-1 rounded border border-white/5">
            <span class="text-[9px] text-gray-500 font-bold mr-2 uppercase">Ekran Sayısı:</span>
            <button onclick="updateLayout(1, this)" class="btn-layout active-layout">1</button>
            <button onclick="updateLayout(2, this)" class="btn-layout">2</button>
            <button onclick="updateLayout(3, this)" class="btn-layout">3</button>
            <button onclick="updateLayout(4, this)" class="btn-layout">4</button>
        </div>
    </header>

    <main class="main-content">
        <div id="chart-grid" class="grid-1">
            <div id="box_1" class="chart-box"></div>
            <div id="box_2" class="chart-box hidden"></div>
            <div id="box_3" class="chart-box hidden"></div>
            <div id="box_4" class="chart-box hidden"></div>
        </div>
    </main>

    <footer class="footer-fixed">
        <span class="text-yellow-600 font-bold mr-2">YASAL UYARI:</span> Yatırım tavsiyesi değildir. Senkronizasyon için Bulut simgesini kullanın.
    </footer>

    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    <script>
        let currentSymbol = 'CAPITALCOM:US100';
        let currentLayout = 1;

        function initChart(id, sym) {
            new TradingView.widget({
                "autosize": true,
                "symbol": sym,
                "interval": "1",
                "theme": "dark",
                "style": "1",
                "locale": "tr",
                "toolbar_bg": "#131722",
                "hide_side_toolbar": false,
                "allow_symbol_change": true,
                "container_id": id,
                "withdateranges": true,
                "show_popup_button": true,
                "remember_last_used_chart": true,
                "charts_storage_url": "https://saveload.tradingview.com",
                "charts_storage_api_version": "1.1",
                "client_id": "tradingview.com",
                "user_id": "public_user_id",
                "enabled_features": [
                    "header_saveload", 
                    "auto_save_and_load_chart",
                    "header_resolutions",
                    "header_settings",
                    "header_indicators",
                    "header_undo_redo"
                ]
            });
        }

        function updateLayout(n, btn) {
            currentLayout = n;
            const grid = document.getElementById('chart-grid');
            
            // Buton Stilini Güncelle
            document.querySelectorAll('.btn-layout').forEach(b => b.classList.remove('active-layout'));
            if(btn) btn.classList.add('active-layout');

            // Grid Sınıfını Güncelle
            grid.className = `grid-${n}`;

            // Chartları Yönet
            for(let i=1; i<=4; i++) {
                const box = document.getElementById(`box_${i}`);
                if(i <= n) {
                    box.classList.remove('hidden');
                    initChart(`box_${i}`, currentSymbol);
                } else {
                    box.classList.add('hidden');
                    box.innerHTML = ""; // Kaynak tüketimini önlemek için temizle
                }
            }
        }

        // İlk açılışta 1'li ekranı yükle
        window.onload = () => {
            updateLayout(1);
        };
    </script>
</body>
</html>
